<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>æ–‡é’¦çš„æœèŠ±å¤•æ‹¾</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2018-09-17T12:07:21.000Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>æ–‡é’¦</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>å¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”QA</title>
    <link href="http://yoursite.com/2018/08/09/%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%B4%A2%E2%80%94%E2%80%94QA/"/>
    <id>http://yoursite.com/2018/08/09/å¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”QA/</id>
    <published>2018-08-09T11:49:09.000Z</published>
    <updated>2018-09-17T12:07:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>é€šè¿‡ä¹‹å‰çš„æ–‡ç« ï¼Œæˆ‘å·²ç»æŠŠå¤œé—´æ¨¡å¼çš„å®ç°å’ŒåŸç†éƒ½åˆ†æå®Œäº†ï¼Œå°½ç®¡æ–¹æ¡ˆå·²ç»æ»¡è¶³å¤§éƒ¨åˆ†æƒ…å†µä¸‹çš„éœ€æ±‚ï¼Œä½†æ˜¯å®è·µè¿‡ç¨‹ä¸­è¿˜æ˜¯è¸©äº†å¾ˆå¤šå‘ã€‚æœ¬æ–‡å°±ä»¥ QA çš„å½¢å¼æŠŠå¤œé—´æ¨¡å¼çš„é‡åˆ°çš„é—®é¢˜ç®€è¦èŠä¸€èŠï¼Œå¸Œæœ›å¯ä»¥å¯¹è¯¸ä½æœ‰æ‰€å¯å‘</p><p><img src="http://ww1.sinaimg.cn/large/0077b3hzgy1fuz1ob4xeqj30m80goq34.jpg" alt="qa"></p><a id="more"></a><ul><li><p><strong>å¤œé—´æ¨¡å¼ä¸‹ Toolbar å³ä¾§å±•å¼€èœå•æ ä¸ç”Ÿæ•ˆ</strong></p><p>å› ä¸º Toolbar çš„å±•å¼€èœå•æ è‡ªå®šä¹‰æ ·å¼æ¯”è¾ƒéº»çƒ¦ï¼Œä½†æ˜¯æˆ‘å‘ç°äº†å¯ä»¥ç”¨ <code>setPopupTheme</code> æ¥æ”¹å˜ Toolbar ä¸»é¢˜ ~è¿™æ ·ï¼Œå¤œé—´æ¨¡å¼ä¸‹çš„èœå•æ çš„èƒŒæ™¯è‰²ä¼šå˜æˆé»‘è‰²ï¼Œå­—ä½“ä¼šå˜æˆç™½è‰²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">toolbar.setPopupTheme(NightHelper.isNight() </span><br><span class="line">                      ? R.style.ThemeOverlay_AppCompat_Dark </span><br><span class="line">                      : R.style.ThemeOverlay_AppCompat_Light);</span><br></pre></td></tr></table></figure></li><li><p><strong>å¤œé—´æ¨¡å¼ä¸‹ CheckBox å’Œ RadioButton ä¸ç”Ÿæ•ˆ</strong></p><p>å¦‚æœä½ ä½¿ç”¨åŸç”Ÿçš„ <strong>CheckBox</strong> æˆ–è€… <strong>RadioButton</strong> ä¼šå‘ç°å®ƒä»¬åœ¨å¤œé—´æ¨¡å¼ä¸‹é¢œè‰²æ˜¯ä¸ä¼šæ”¹å˜ï¼Œå› ä¸ºå®ƒæ²¡æœ‰ä½¿ç”¨ä½ å¤œé—´æ¨¡å¼ä¸‹çš„èµ„æºè‰²å€¼ğŸ˜‘  é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œåœ¨ res/color ä¸­æ–°å»ºä¸€ä¸ª thint.xml è®¾ç½®å¥½é¢œè‰²</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">selector</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:color</span>=<span class="string">"@color/night_gray"</span> <span class="attr">android:state_enabled</span>=<span class="string">"false"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:color</span>=<span class="string">"@color/night_blue"</span> <span class="attr">android:state_checked</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:color</span>=<span class="string">"@color/night_gray"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">selector</span>&gt;</span>`</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨ <code>app:buttonTint</code> ä¸­æŠŠ thint.xml è®¾ç½®è¿›å»å°±å¯ä»¥å•¦~</p></li><li><p><strong>å¤œé—´æ¨¡å¼ä¸‹ TabLayout å¤šçŠ¶æ€çš„ Text é¢œè‰²å¼‚å¸¸</strong></p><p>å¯¹äºå­—ä½“é¢œè‰²ï¼Œé»˜è®¤çš„åšæ³•æ˜¯é€šè¿‡ getResourceId æ¥è·å–èµ„æº Idï¼Œä½†åƒ TabLayout è¿™ç§<strong>å¤šçŠ¶æ€</strong>çš„é¢œè‰²å€¼åœ¨ TextView ä¸­æ˜¯ä½¿ç”¨ <code>ColorStateList</code> æ¥ç»´æŠ¤å¤šç§çŠ¶æ€è‰²å€¼~ </p><p>ä½†æ˜¯ï¼ä¸èƒ½ä½¿ç”¨ <code>TypedArray # getColorStateList</code>ï¼Œå› ä¸ºæ‹¿åˆ°çš„ ColorStateList æ˜¯å½“å‰æ¨¡å¼ä¸‹åˆ†é…å¥½çš„é¢œè‰²å€¼ï¼Œä¸ä¼šéšç€æ¨¡å¼çš„æ”¹å˜è€Œæ”¹å˜ğŸ˜‘ï¼Œ è¿˜æ˜¯å¾—æ ¹æ® <code>TypedArray # getResourceId</code> å’Œ <code>getResources # getColorStateList</code> æ¥è·å¾—ç›¸åº”çš„ ColorStateList</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">setColorStateList</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (targetView <span class="keyword">is</span> TextView) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ContextCompat.getColorStateList(context, textColorId)?.also &#123;</span><br><span class="line">                targetView.setTextColor(it) </span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e: Exception) &#123;</span><br><span class="line">            e.printStackTrace()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>setNightCallback è¿™ä¸ªæ–¹æ³•å¥½éº»çƒ¦å“¦ï¼Œèƒ½ä¸èƒ½åå‘æŸ¥è‰²å€¼</strong></p><p>å¦‚æœé‡åˆ°äº†åœ¨ä»£ç é‡ŒåŠ¨æ€è®¾ç½®é¢œè‰²å€¼ï¼Œæˆ‘å°±æ²¡æ³•è·å–åˆ°å®ƒçš„ rescourceIdï¼Œæ‰€ä»¥åªèƒ½ä½¿ç”¨ <code>setNightCallback</code> çš„å›è°ƒä¸­å†æ¸²æŸ“ä¸€æ¬¡ã€‚æ³¨æ„ğŸ‘»ï¼è¿™ä¸ªè§„åˆ™åªéœ€è¦åº”ç”¨äºåœ¨ MainActivity ä¸­çš„ Viewï¼Œå› ä¸ºåˆ‡æ¢å¤œé—´æ¨¡å¼å®ƒè¦é‡æ–°æ¸²æŸ“ï¼Œå…¶å®ƒæƒ…å†µçš„ View å¯ä»¥ä¸ºæ‰€æ¬²ä¸ºï¼Œæ— é¡»åœ¨æ„è¿™ä¸ª~</p><p>é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œä¸èƒ½é€šè¿‡é¢œè‰²å€¼åæŸ¥ rescourceId çš„åŸå› æ˜¯å› ä¸ºæ—¥é—´æ¨¡å¼ä¸‹åŒä¸€ç§é¢œè‰²å¯èƒ½å¯¹åº” n ä¸ªå¤œé—´æ¨¡å¼çš„è‰²å€¼ï¼ŒåæŸ¥ä¼šè®©è§„åˆ™å˜å¾—å¤æ‚ä¸”éº»çƒ¦â€¦â€¦</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--color in day mode--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">"white_background"</span>&gt;</span>#ffffff<span class="tag">&lt;/<span class="name">color</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">"white_text"</span>&gt;</span>#0ffffff<span class="tag">&lt;/<span class="name">color</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--color in nihgt mode--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">"white_background"</span>&gt;</span>#000000<span class="tag">&lt;/<span class="name">color</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">"white_text"</span>&gt;</span>#000009<span class="tag">&lt;/<span class="name">color</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p><strong>setLocalNightMode æ²¡ç”¨ï¼Œé‚£è¦æ€ä¹ˆç¦ç”¨å¤œé—´æ¨¡å¼</strong></p><p>è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ç›®å‰æ²¡æœ‰æ¯”è¾ƒå¥½çš„æ–¹æ¡ˆï¼Œå»ºè®®ä½¿ç”¨æ²¡æœ‰å¤œé—´æ¨¡å¼å¯¹åº”è‰²å€¼çš„é¢œè‰²ï¼Œæ–°å¢ä¸€ç§é¢œè‰²å‘½åè§„åˆ™æ¥è¡¨ç¤ºå³å¯~</p><p>å¦‚æœæœ‰æ›´å¥½çš„æ–¹æ¡ˆï¼Œååˆ†æ¬¢è¿ä¸æˆ‘è®¨è®º~</p></li><li><p><strong>å¤œé—´æ¨¡å¼ä¸‹å›¾ç‰‡åŠ è½½å¤§å°ä¸å¯¹</strong></p><p>å›¾ç‰‡èµ„æºä¸èƒ½å…¨éƒ¨æ”¾åœ¨ drawable-night ä¸­ï¼Œå®ƒæ˜¯å¯¹åº” drawableï¼›å¦‚æœæ˜¯å›¾ç‰‡èµ„æºæœ‰å¯¹åº”å…³ç³»ï¼Œåº”è¯¥çœ‹å®ƒåŸå…ˆçš„ä½ç½®ï¼ŒæŠŠèµ„æºæ–‡ä»¶æ”¾åœ¨ç›¸åº”çš„ <code>drawable-night-[dpi]</code> ä¸­</p></li><li><p><strong>Header å’Œ Footer åœ¨ä¸å¯è§æ—¶ï¼Œåˆ‡æ¢å¤œé—´æ¨¡å¼åæ²¡æœ‰ç”Ÿæ•ˆ</strong></p><p>å› ä¸º Header å’Œ Footer åœ¨åˆå§‹åŒ–çš„æ—¶å€™è¢«æ·»åŠ è¿›å»çš„ï¼Œæ‰€ä»¥åœ¨åˆ‡æ¢å¤œé—´æ¨¡å¼çš„æ—¶å€™ï¼Œå¦‚æœå®ƒä»¬ä¸å¯è§ï¼Œå°±ä¸åœ¨ resetView çš„é‡æ¸²æŸ“èŒƒå›´å†…ã€‚</p><p>è§£å†³çš„æ–¹æ³•æ˜¯åœ¨åˆ‡æ¢å¤œé—´æ¨¡å¼çš„æ—¶å€™å¯¹ Header æˆ–è€… Footer è°ƒç”¨ resetView é‡æ¸²æŸ“å®ƒä»¬çš„é¢œè‰²</p></li><li><p><strong>å¤œé—´æ¨¡å¼ä¸‹ Dialog ä¸ç”Ÿæ•ˆ</strong></p><p>å¯¹äºåŸç”Ÿçš„ AlertDialogï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªå¤œé—´æ¨¡å¼ä¸‹ Dialog çš„ä¸»é¢˜</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"Dialog.Night"</span> <span class="attr">parent</span>=<span class="string">"Theme.AppCompat.Dialog.Alert"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:windowBackground"</span>&gt;</span>@color/night_white<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorAccent"</span>&gt;</span>@color/night_accent<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorPrimary"</span>&gt;</span>@color/night_text<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorPrimaryDark"</span>&gt;</span>@color/night_black<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ¥ç€åˆ›å»º <code>AlertDialog.Builder</code>ï¼Œåœ¨å¤œé—´æ¨¡å¼ä¸‹åº”ç”¨å¤œé—´ä¸»é¢˜</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AlertDialog.Builder(<span class="keyword">if</span> (NightHelper.isNight())</span><br><span class="line">        ContextThemeWrapper(context, R.style.Dialog_Night) <span class="keyword">else</span> context)</span><br></pre></td></tr></table></figure></li><li><p><strong>ä½¿ç”¨ WebView å¤œé—´æ¨¡å¼å¼‚å¸¸</strong></p><p>å› ä¸º WebView ç¬¬ä¸€æ¬¡åˆå§‹åŒ–çš„æ—¶å€™ä¼š reset UI mode, å¯¼è‡´è¯¥é¡µé¢ä¸‹åœ¨ WebView åˆå§‹åŒ–åæ¸²æŸ“çš„ View éƒ½ä¼šæ¢å¤æ—¥é—´æ¨¡å¼ï¼Œè¯¦è§ <a href="https://groups.google.com/forum/#!msg/google-admob-ads-sdk/OZzHq_-wAFY/K50jClZcBAAJ" target="_blank" rel="noopener">Google çš„è®¨è®º</a></p><p>è¿™ä¸ªé—®é¢˜è§£å†³èµ·æ¥ä¹Ÿæ¯”è¾ƒå®¹æ˜“ï¼Œåœ¨ WebView åˆå§‹åŒ–åè°ƒç”¨ <code>setLocalNightMode</code> æ¢å¤å¤œé—´æ¨¡å¼ï¼Œè®©å®ƒä¹‹åçš„ View æŒ‰ç…§å¤œé—´æ¨¡å¼çš„è§„åˆ™æ¸²æŸ“å³å¯ã€‚ä¸è¿‡ï¼Œä½¿ç”¨è¿™å¥—è§„åˆ™çš„ Activity éƒ½è¦æ·»åŠ   <code>android:configChanges=&quot;uiMode&quot;</code></p></li><li><p><strong>Web é¡µé¢æ²¡æœ‰å¤œé—´æ¨¡å¼å‘€</strong></p><p>é¦–å…ˆï¼Œå¦‚æœäº§å“éœ€è¦æ”¹å‰ç«¯ Web é¡µé¢é¢œè‰²ï¼Œé‚£ä¹ˆéœ€è¦å’Œå‰ç«¯åŒå­¦ä¸€èµ·é…åˆï¼ŒæŠŠä½ å½“å‰çš„çŠ¶æ€å‘Šè¯‰ä»–ã€‚å¦‚æœè¿™å—å‰ç«¯åŒå­¦è¿˜æ²¡å‡†å¤‡å¥½ï¼Œé‚£å¯ä»¥ä½¿ç”¨åœ¨ WebView ä¸­é‡å†™ onDraw çš„æ–¹æ³•ï¼Œè°ƒç”¨ canvas # drawColor ç»™ WebView æ·»åŠ ä¸€ä¸ªé®ç½©</p></li><li><p><strong>å›¾ç‰‡é®ç½©çš„å®ç°</strong></p><p>è¿™ä¸ªä¹Ÿæ˜¯ä¸€ä¸ªå¤æ‚çš„åŠŸèƒ½ï¼Œåº”ç”¨æ˜¯å¦éœ€è¦å–å†³ä½ çš„è®¾è®¡å’Œäº§å“å®šä½ï¼Œæ‰€ä»¥æ²¡æœ‰å±•å¼€è®²ï¼Œä¸»è¦çš„æ€è·¯è¿˜æ˜¯ç»™ <code>ImageView # setColorFilter</code></p><p>å¦‚æœæ˜¯å¯¹ TextView è®¾ç½®äº† drawableLeft ä¹‹ç±»çš„ï¼Œéœ€è¦å¯¹ TextView çš„ drawable è¿›è¡ŒåŠ é®ç½©å¤„ç†</p><p>å¦‚æœå›¾ç‰‡åŸå…ˆæœ‰é®ç½©ï¼Œå¤œé—´æ¨¡å¼éœ€è¦è€ƒè™‘åŸå…ˆçš„é®ç½©ï¼Œæ‰€ä»¥éœ€è¦æä¾›å¤–éƒ¨æ–¹æ³•ç¦ç”¨æŸäº›å›¾ç‰‡ä¸åŠ é®ç½©</p></li></ul><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>æœ¬æ–‡æŠŠåœ¨å®é™…å¼€å‘ä¸­é‡åˆ°çš„å°é—®é¢˜åˆ†äº«å‡ºæ¥ï¼Œå¦‚æœå¤§å®¶é‡åˆ°ä»€ä¹ˆç–‘æƒ‘ä¹Ÿå¯ä»¥ä¸æˆ‘è®¨è®ºï¼ŒæŠŠæ›´å¤šæƒ…å†µæ›´æ–°åˆ°æ–‡ç« ä¸­ğŸ‰ğŸ‰</p><h4 id="å¤œé—´æ¨¡å¼ç³»åˆ—æ–‡ç« "><a href="#å¤œé—´æ¨¡å¼ç³»åˆ—æ–‡ç« " class="headerlink" title="å¤œé—´æ¨¡å¼ç³»åˆ—æ–‡ç« "></a>å¤œé—´æ¨¡å¼ç³»åˆ—æ–‡ç« </h4><p><a href="http://wenqin231.com/2018/06/19/%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%B4%A2%E2%80%94%E2%80%94%E5%BC%80%E7%AF%87/" target="_blank" rel="noopener">å¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”å¼€ç¯‡</a></p><p><a href="http://wenqin231.com/2018/08/08/%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%B4%A2%E2%80%94%E2%80%94%E5%B1%95%E5%BC%80%E8%AE%B2%E8%AE%B2/" target="_blank" rel="noopener">å¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”å±•å¼€è®²è®²</a></p><p><a href="">å¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”æºç åˆ†æ</a></p><p><a href="http://wenqin231.com/2018/08/09/%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%B4%A2%E2%80%94%E2%80%94QA/" target="_blank" rel="noopener">å¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”QA</a></p><p><em>å‚è€ƒèµ„æ–™</em></p><p><a href="https://medium.com/androiddevelopers/appcompat-v23-2-daynight-d10f90c83e94" target="_blank" rel="noopener">AppCompatâ€Šâ€”â€ŠDayNight</a></p><p><a href="https://www.jianshu.com/p/3b55e84742e5" target="_blank" rel="noopener">çŸ¥ä¹å’Œç®€ä¹¦çš„å¤œé—´æ¨¡å¼å®ç°å¥—è·¯</a></p><p><strong>æ¬¢è¿å¤§å®¶æ¥å³åˆ»æ‰¾æˆ‘ç©</strong></p><p><img src="http://ww1.sinaimg.cn/large/0077b3hzgy1fuxyhhcjfcj309e0goaaw.jpg" alt="jike"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;é€šè¿‡ä¹‹å‰çš„æ–‡ç« ï¼Œæˆ‘å·²ç»æŠŠå¤œé—´æ¨¡å¼çš„å®ç°å’ŒåŸç†éƒ½åˆ†æå®Œäº†ï¼Œå°½ç®¡æ–¹æ¡ˆå·²ç»æ»¡è¶³å¤§éƒ¨åˆ†æƒ…å†µä¸‹çš„éœ€æ±‚ï¼Œä½†æ˜¯å®è·µè¿‡ç¨‹ä¸­è¿˜æ˜¯è¸©äº†å¾ˆå¤šå‘ã€‚æœ¬æ–‡å°±ä»¥ QA çš„å½¢å¼æŠŠå¤œé—´æ¨¡å¼çš„é‡åˆ°çš„é—®é¢˜ç®€è¦èŠä¸€èŠï¼Œå¸Œæœ›å¯ä»¥å¯¹è¯¸ä½æœ‰æ‰€å¯å‘&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://ww1.sinaimg.cn/large/0077b3hzgy1fuz1ob4xeqj30m80goq34.jpg&quot; alt=&quot;qa&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>å¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”æºç åˆ†æ</title>
    <link href="http://yoursite.com/2018/08/09/%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%B4%A2%E2%80%94%E2%80%94%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"/>
    <id>http://yoursite.com/2018/08/09/å¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”æºç åˆ†æ/</id>
    <published>2018-08-09T07:17:39.000Z</published>
    <updated>2018-09-09T18:20:30.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨<a href="http://wenqin231.com/2018/08/08/%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%B4%A2%E2%80%94%E2%80%94%E5%B1%95%E5%BC%80%E8%AE%B2%E8%AE%B2/" target="_blank" rel="noopener">ä¸Šæ–‡</a>çš„ç»“å°¾è°ˆåˆ°äº†ä¸€ä¸ªæ–°çš„éœ€æ±‚â€”â€”å‡è®¾æŸä¸ªé¡µé¢ä¸éœ€è¦å¤œé—´æ¨¡å¼ï¼Œé‚£ä¹ˆå°±è°ƒç”¨ <code>setLocalNightMode</code> æ¥æ”¹å˜å¤œé—´æ¨¡å¼çŠ¶æ€ï¼Œä»è€Œå–æ¶ˆæ‰è¿™ä¸ªé¡µé¢çš„å¤œé—´æ¨¡å¼ï¼Œä½†æ˜¯å…¶å®è¿™ç§æ–¹å¼ä¼šå½±å“åˆ°ä¸Šä¸€ä¸ªé¡µé¢çš„ UI ~</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">setLocalNightMode</span><span class="params">(activity: <span class="type">AppCompatActivity</span>, isNight: <span class="type">Boolean</span>)</span></span> &#123;</span><br><span class="line">    activity.delegate.setLocalNightMode(<span class="keyword">if</span> (isNight)</span><br><span class="line">        AppCompatDelegate.MODE_NIGHT_YES <span class="keyword">else</span> AppCompatDelegate.MODE_NIGHT_NO)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å›é¡¾ä¹‹å‰å°è£…çš„ <code>setLocalNightMode</code> å¯ä»¥å‘ç°ï¼Œè°ƒç”¨çš„ä¸»è§’æ˜¯ <code>activity # delegate</code>ï¼Œä½†æ˜¯å®ƒä¸ä»…æ”¹å˜äº†å½“å‰ Activity çš„å¤œé—´æ¨¡å¼ï¼Œç”šè‡³è¿å…¶å®ƒã€Œæ´»ç€çš„ã€Activity ä¹Ÿè¢«å…¶è¿ç´¯ã€‚é‚£è¿™ç©¶ç«Ÿæ˜¯æ€ä¹ˆä¸€å›äº‹ï¼Œæœ¬æ–‡å°†åˆ†æè¿™å…¶ä¸­çš„æºç å®ç°ï¼Œå¸®åŠ©è¯»è€…æ›´å¥½åœ°ç†è§£è¿™å¥—å®˜æ–¹çš„ Android å¤œé—´æ¨¡å¼</p><p><img src="http://ww1.sinaimg.cn/large/0077b3hzgy1fuz1obcklsj30m80gowgl.jpg" alt="dev"></p><a id="more"></a><p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ <code>setLocalNightMode</code> çš„è°ƒç”¨ä¸»è§’ <code>getDelegate</code>ï¼Œåœ¨ <code>AppCompatActivity</code> ä¸­æ‰¾åˆ° <code>getDelegate</code> çš„å…·ä½“å®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@NonNull</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> AppCompatDelegate <span class="title">getDelegate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (mDelegate == <span class="keyword">null</span>) &#123;</span><br><span class="line">        mDelegate = AppCompatDelegate.create(<span class="keyword">this</span>, <span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> mDelegate;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªæ‡’æ±‰å¼çš„å•ä¾‹ï¼Œé€šè¿‡ <code>AppCompatDelegate # create</code> æ¥è·å¾— <code>mDelegate</code>ã€‚<code>AppCompatDelegate</code> æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œåœ¨å®ƒçš„ <code>create</code> æ–¹æ³•ä¸­æ ¹æ®ä¸åŒçš„ Android ç‰ˆæœ¬åˆ›å»ºå¯¹åº”çš„ç»§æ‰¿ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> AppCompatDelegate <span class="title">create</span><span class="params">(Context context, Window window,</span></span></span><br><span class="line"><span class="function"><span class="params">        AppCompatCallback callback)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= <span class="number">24</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AppCompatDelegateImplN(context, window, callback);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= <span class="number">23</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AppCompatDelegateImplV23(context, window, callback);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AppCompatDelegateImplV14(context, window, callback);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç®€å•åœ°çœ‹è¿™å‡ ä¸ªç±»ï¼Œå°±ä¼šå‘ç°æœ€ä¸»è¦çš„å®ç°æ˜¯åœ¨ <code>AppCompatDelegateImplV14</code>ï¼Œå…¶ä»–ç±»çš„æ‰©å±•æ–¹æ³•ä¸å¤œé—´æ¨¡å¼æ— å…³ï¼Œé¡ºä¾¿æˆ‘ä»¬è·å¾—ä¸€ä¸ªæœ‰ç”¨çš„ä¿¡æ¯ï¼Œå½“å‰å¤œé—´æ¨¡å¼çš„åŠŸèƒ½æœ€ä½æ”¯æŒ API14 ~</p><p>æ¥ç€ï¼Œæˆ‘ä»¬åœ¨ <code>AppCompatDelegateImplV14</code> ä¸­æ‰¾åˆ°äº† <code>setLocalNightMode</code> çš„å…·ä½“å®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLocalNightMode</span><span class="params">(@NightMode <span class="keyword">final</span> <span class="keyword">int</span> mode)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (mode) &#123;</span><br><span class="line">        <span class="keyword">case</span> MODE_NIGHT_AUTO:</span><br><span class="line">        <span class="keyword">case</span> MODE_NIGHT_NO:</span><br><span class="line">        <span class="keyword">case</span> MODE_NIGHT_YES:</span><br><span class="line">        <span class="keyword">case</span> MODE_NIGHT_FOLLOW_SYSTEM:</span><br><span class="line">            <span class="keyword">if</span> (mLocalNightMode != mode) &#123;</span><br><span class="line">                mLocalNightMode = mode;</span><br><span class="line">                <span class="keyword">if</span> (mApplyDayNightCalled) &#123;</span><br><span class="line">                    <span class="comment">// If we've already applied day night, re-apply since we won't be</span></span><br><span class="line">                    <span class="comment">// called again</span></span><br><span class="line">                    applyDayNight();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">     ....</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»ä»£ç ä¸­çœ‹å‡ºï¼Œ<code>setLocalNightMode</code> é™¤äº†æŠŠ mode èµ‹å€¼ç»™ mLocalNightMode å¤–ï¼Œè¿˜ä¼šè°ƒç”¨ä¸€é <code>applyDayNight</code> æ¥ä½¿å¤œé—´æ¨¡å¼ç”Ÿæ•ˆã€‚é¡ºå¸¦ä¸€æï¼Œ <code>appDayNight</code> è¿˜ä¼šåœ¨ Activity çš„ <code>onCreate</code> å’Œ <code>onStart</code> ä¸­è¢«è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯ Activity å¯åŠ¨çš„æ—¶å€™å°±ä¼šæ ¹æ® mode æ¥é€‚é…å¤œé—´æ¨¡å¼~ </p><p>é‚£æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒçš„å®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">applyDayNight</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">boolean</span> applied = <span class="keyword">false</span>;</span><br><span class="line">    <span class="meta">@NightMode</span> <span class="keyword">final</span> <span class="keyword">int</span> nightMode = getNightMode();</span><br><span class="line">    <span class="meta">@ApplyableNightMode</span> <span class="keyword">final</span> <span class="keyword">int</span> modeToApply = mapNightMode(nightMode);</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">if</span> (modeToApply != MODE_NIGHT_FOLLOW_SYSTEM) &#123;</span><br><span class="line">        applied = updateForNightMode(modeToApply);</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">    mApplyDayNightCalled = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">return</span> applied;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆå®ƒæ˜¯é€šè¿‡ <code>getNightMode</code> å’Œ <code>mapNightMode</code> è·å¾—æœ€ç»ˆ modeï¼Œæˆ‘ä»¬å…ˆçœ‹å‰è€…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@NightMode</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getNightMode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> mLocalNightMode != MODE_NIGHT_UNSPECIFIED ? </span><br><span class="line">        mLocalNightMode : getDefaultNightMode();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»æ–¹æ³•ä¸­å¯ä»¥çœ‹å‡ºæ¥ï¼Œå¦‚æœ mLocalNightMode æ˜¯æœ‰æ•ˆå€¼ï¼Œå°±ä½¿ç”¨ mLocalNightMode, å¦åˆ™ä½¿ç”¨ <code>getDefalutNightMode</code>ã€‚<code>getDefalutNightMode</code> æ˜¯  <code>AppCompatDelegate</code> ä¸­çš„æ–¹æ³•ï¼Œå®ƒè¿”å› <code>stDefaultNightMode</code> è®¾ç½®çš„ modeã€‚è¿™ä¸ªæ–¹æ³•å‘Šè¯‰äº†æˆ‘ä»¬ï¼ŒlocalNightMode ä¼˜å…ˆäº defalutNightMode !</p><p><code>mapNightMode</code> åªæ˜¯å¯¹ mode çš„ç±»å‹è½¬æ¢ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚å›è¿‡å¤´æ¥ç»§ç»­çœ‹ <code>applyDayNight</code>~ å½“æˆ‘ä»¬æŠŠå¤œé—´æ¨¡å¼çš„ mode è®¾ç½®ä¸º<code>MODE_NIGHT_YES</code> æˆ–è€… <code>MODE_NIGHT_NO</code> æ—¶ï¼Œå°±ä¼šè§¦å‘ <code>updateForNightMode</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Updates the &#123;<span class="doctag">@link</span> Resources&#125; configuration &#123;<span class="doctag">@code</span> uiMode&#125; with the</span></span><br><span class="line"><span class="comment"> * chosen &#123;<span class="doctag">@code</span> UI_MODE_NIGHT&#125; value.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">updateForNightMode</span><span class="params">(@ApplyableNightMode <span class="keyword">final</span> <span class="keyword">int</span> mode)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Resources res = mContext.getResources();</span><br><span class="line">    <span class="keyword">final</span> Configuration conf = res.getConfiguration();</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> currentNightMode = conf.uiMode &amp; Configuration.UI_MODE_NIGHT_MASK;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> newNightMode = (mode == MODE_NIGHT_YES)</span><br><span class="line">            ? Configuration.UI_MODE_NIGHT_YES</span><br><span class="line">            : Configuration.UI_MODE_NIGHT_NO;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (currentNightMode != newNightMode) &#123;</span><br><span class="line">        <span class="keyword">if</span> (shouldRecreateOnNightModeChange()) &#123;</span><br><span class="line">            ...</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            ...</span><br><span class="line">            <span class="keyword">final</span> Configuration config = <span class="keyword">new</span> Configuration(conf);</span><br><span class="line">            <span class="keyword">final</span> DisplayMetrics metrics = res.getDisplayMetrics();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// Update the UI Mode to reflect the new night mode</span></span><br><span class="line">            config.uiMode = newNightMode | </span><br><span class="line">                (config.uiMode &amp; ~Configuration.UI_MODE_NIGHT_MASK);</span><br><span class="line">            res.updateConfiguration(config, metrics);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçœç•¥äº†ä¸€äº›ä»£ç ï¼Œå…³é”®çš„ä»£ç æ˜¯ <code>Resoures # updateConfiguration</code>ï¼Œå®ƒä¼šæ›´æ–°èµ„æºæ–‡ä»¶çš„å¼•ç”¨è§„åˆ™â€”â€”ä¼˜å…ˆä½¿ç”¨ night æ–‡ä»¶ä¸‹çš„èµ„æºï¼Œèµ„æºç¼ºå¤±æ‰ä½¿ç”¨é»˜è®¤èµ„æº</p><p>åˆ†æåˆ°è¿™é‡Œï¼Œç»ˆäºæç„¶å¤§æ‚Ÿï¼å› ä¸º <code>setLocalNightMode</code> æœ€ç»ˆæ›´æ”¹çš„æ˜¯å…¨å±€çš„èµ„æºæ–‡ä»¶å¼•ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æ˜¯åœ¨å½“å‰é¡µé¢ä¿®æ”¹çš„å¤œé—´æ¨¡å¼ï¼Œå…¶å®ä¹Ÿä¼šå¯¹å…¶ä»–å¯åŠ¨ç€çš„é¡µé¢æœ‰æ‰€å½±å“~</p><p><img src="https://ws1.sinaimg.cn/large/0077b3hzgy1fv3pbs5jz5j308m06lq38.jpg" alt="soga"></p><p>å› æ­¤ï¼Œå¦‚æœä¸€ä¸ªé¡µé¢æƒ³ç¦ç”¨å¤œé—´æ¨¡å¼ï¼Œåªèƒ½æŠŠè‰²å€¼æ¢æˆæ²¡æœ‰é…å¯¹å¤œé—´æ¨¡å¼çš„è‰²å€¼~ å½“ç„¶ï¼Œå¦‚æœæœ‰æ›´å¥½çš„æ–¹å¼ï¼Œæ¬¢è¿ä¸æˆ‘è®¨è®º~</p><h4 id="æ›´å¤šç»†èŠ‚"><a href="#æ›´å¤šç»†èŠ‚" class="headerlink" title="æ›´å¤šç»†èŠ‚"></a>æ›´å¤šç»†èŠ‚</h4><p>è™½ç„¶å¤œé—´æ¨¡å¼çš„å¤§ä½“å®ç°å’ŒåŸç†æˆ‘éƒ½åˆ†æè¿‡äº†ï¼Œä½†æ˜¯è¿˜æœ‰å¾ˆå¤šç»†èŠ‚é—®é¢˜ä¸å¤ªé€‚åˆèŠ±å¤§é‡çš„ç¯‡å¹…æè¿°ã€‚å› æ­¤ï¼Œåœ¨<a href="http://wenqin231.com/2018/08/09/%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%B4%A2%E2%80%94%E2%80%94QA/" target="_blank" rel="noopener">ã€Œå¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”QAã€</a>ä¸­ï¼Œå°†ä¼šä»¥é—®ç­”çš„å½¢å¼å¯¹è¿™äº›ç»†èŠ‚åšé€ä¸€åˆ†æï¼Œæ­å€™æŸ¥é˜…~</p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>å½“æˆ‘ä»¬é€šè¿‡ <code>setDefalutNightMode</code> çš„æ—¶å€™ï¼Œ<code>Activity # onCreate</code> ä¼šè°ƒç”¨ <code>applyDayNight</code>ï¼Œå†…éƒ¨ä¼šæ ¹æ® defaultNightMode æ¥ç¡®å®šèµ„æºå¼•ç”¨æ–¹å¼ï¼›å½“æˆ‘ä»¬åˆ‡æ¢å¤œé—´æ¨¡å¼æ—¶ï¼Œæˆ‘ä»¬ä¼šè°ƒç”¨ <code>setLocalNightMode</code>ï¼Œè¿™ä¸ªæ–¹æ³•å†…ä¼šè°ƒç”¨ <code>applyDayNight</code>ï¼Œå†…éƒ¨æ˜¯å¿½ç•¥ä¹‹å‰çš„ defalutNightModeï¼Œè€Œæ˜¯ç”¨ localNightMode æ¥ç¡®å®šæ–°çš„èµ„æºå¼•ç”¨æ–¹å¼ã€‚å› ä¸ºå½“å‰é¡µé¢çš„ UI å·²ç»æ¸²æŸ“å®Œæˆäº†ï¼Œæ–°çš„èµ„æºå¼•ç”¨æ–¹å¼åªå¯¹è°ƒç”¨ <code>setLocalNightMode</code> åçš„æ¸²æŸ“æœ‰æ•ˆï¼Œæ‰€ä»¥å®˜æ–¹å»ºè®®é…åˆ activity # recreate æ¥å®ç°ã€‚ä½†æ˜¯é‡å¯é¡µé¢ UI ä¸Šä¸å‹å¥½ï¼Œæ•…ä½¿ç”¨ <code>NightHeper # resetViews</code> å¯¹æ¸²æŸ“å¥½çš„ UI é€’å½’éå†ï¼Œé‡æ–°æ¸²æŸ“~</p><h4 id="å¤œé—´æ¨¡å¼ç³»åˆ—æ–‡ç« "><a href="#å¤œé—´æ¨¡å¼ç³»åˆ—æ–‡ç« " class="headerlink" title="å¤œé—´æ¨¡å¼ç³»åˆ—æ–‡ç« "></a>å¤œé—´æ¨¡å¼ç³»åˆ—æ–‡ç« </h4><p><a href="http://wenqin231.com/2018/06/19/%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%B4%A2%E2%80%94%E2%80%94%E5%BC%80%E7%AF%87/" target="_blank" rel="noopener">å¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”å¼€ç¯‡</a></p><p><a href="http://wenqin231.com/2018/08/08/%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%B4%A2%E2%80%94%E2%80%94%E5%B1%95%E5%BC%80%E8%AE%B2%E8%AE%B2/" target="_blank" rel="noopener">å¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”å±•å¼€è®²è®²</a></p><p><a href="">å¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”æºç åˆ†æ</a></p><p><a href="http://wenqin231.com/2018/08/09/%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%B4%A2%E2%80%94%E2%80%94QA/" target="_blank" rel="noopener">å¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”QA</a></p><p><em>å‚è€ƒèµ„æ–™</em></p><p><a href="https://medium.com/androiddevelopers/appcompat-v23-2-daynight-d10f90c83e94" target="_blank" rel="noopener">AppCompatâ€Šâ€”â€ŠDayNight</a></p><p><a href="https://www.jianshu.com/p/3b55e84742e5" target="_blank" rel="noopener">çŸ¥ä¹å’Œç®€ä¹¦çš„å¤œé—´æ¨¡å¼å®ç°å¥—è·¯</a></p><p><a href="https://www.uisdc.com/tencent-qq-night-mode" target="_blank" rel="noopener">è¶…è¿‡8äº¿äººä½¿ç”¨çš„QQï¼Œæ€»ç»“äº†å¤œé—´æ¨¡å¼è®¾è®¡çš„é€šç”¨æ–¹æ³•</a></p><p><strong>æ¬¢è¿å¤§å®¶æ¥å³åˆ»æ‰¾æˆ‘ç©</strong></p><p><img src="http://ww1.sinaimg.cn/large/0077b3hzgy1fuxyhhcjfcj309e0goaaw.jpg" alt="jike"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨&lt;a href=&quot;http://wenqin231.com/2018/08/08/%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%B4%A2%E2%80%94%E2%80%94%E5%B1%95%E5%BC%80%E8%AE%B2%E8%AE%B2/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ä¸Šæ–‡&lt;/a&gt;çš„ç»“å°¾è°ˆåˆ°äº†ä¸€ä¸ªæ–°çš„éœ€æ±‚â€”â€”å‡è®¾æŸä¸ªé¡µé¢ä¸éœ€è¦å¤œé—´æ¨¡å¼ï¼Œé‚£ä¹ˆå°±è°ƒç”¨ &lt;code&gt;setLocalNightMode&lt;/code&gt; æ¥æ”¹å˜å¤œé—´æ¨¡å¼çŠ¶æ€ï¼Œä»è€Œå–æ¶ˆæ‰è¿™ä¸ªé¡µé¢çš„å¤œé—´æ¨¡å¼ï¼Œä½†æ˜¯å…¶å®è¿™ç§æ–¹å¼ä¼šå½±å“åˆ°ä¸Šä¸€ä¸ªé¡µé¢çš„ UI ~&lt;/p&gt;
&lt;figure class=&quot;highlight kotlin&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;setLocalNightMode&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(activity: &lt;span class=&quot;type&quot;&gt;AppCompatActivity&lt;/span&gt;, isNight: &lt;span class=&quot;type&quot;&gt;Boolean&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    activity.delegate.setLocalNightMode(&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (isNight)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        AppCompatDelegate.MODE_NIGHT_YES &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; AppCompatDelegate.MODE_NIGHT_NO)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å›é¡¾ä¹‹å‰å°è£…çš„ &lt;code&gt;setLocalNightMode&lt;/code&gt; å¯ä»¥å‘ç°ï¼Œè°ƒç”¨çš„ä¸»è§’æ˜¯ &lt;code&gt;activity # delegate&lt;/code&gt;ï¼Œä½†æ˜¯å®ƒä¸ä»…æ”¹å˜äº†å½“å‰ Activity çš„å¤œé—´æ¨¡å¼ï¼Œç”šè‡³è¿å…¶å®ƒã€Œæ´»ç€çš„ã€Activity ä¹Ÿè¢«å…¶è¿ç´¯ã€‚é‚£è¿™ç©¶ç«Ÿæ˜¯æ€ä¹ˆä¸€å›äº‹ï¼Œæœ¬æ–‡å°†åˆ†æè¿™å…¶ä¸­çš„æºç å®ç°ï¼Œå¸®åŠ©è¯»è€…æ›´å¥½åœ°ç†è§£è¿™å¥—å®˜æ–¹çš„ Android å¤œé—´æ¨¡å¼&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://ww1.sinaimg.cn/large/0077b3hzgy1fuz1obcklsj30m80gowgl.jpg&quot; alt=&quot;dev&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>å¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”å±•å¼€è®²è®²</title>
    <link href="http://yoursite.com/2018/08/08/%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%B4%A2%E2%80%94%E2%80%94%E5%B1%95%E5%BC%80%E8%AE%B2%E8%AE%B2/"/>
    <id>http://yoursite.com/2018/08/08/å¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”å±•å¼€è®²è®²/</id>
    <published>2018-08-08T03:21:55.000Z</published>
    <updated>2018-09-09T15:34:14.000Z</updated>
    
    <content type="html"><![CDATA[<p>æ‰¿æ¥ä¸Šæ–‡ï¼Œä½¿ç”¨ <code>setDefaultNightMode</code> æ¥è®¾ç½®å…¨å±€çš„æ—¥å¤œé—´æ¨¡å¼ï¼Œä½†å®ƒå¯¹å¯åŠ¨è¿‡çš„ Activity æ— æ•ˆï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—ä½¿ç”¨ <code>setLocalNightMode</code> è®¾ç½®å¯åŠ¨ç€çš„ Activity çš„å¤œé—´æ¨¡å¼ï¼Œå†å¯¹å¸ƒå±€å†…çš„ View é‡æ–°æ¸²æŸ“é¢œè‰²å€¼æ¥åˆ‡æ¢å¤œé—´æ¨¡å¼ã€‚è¿™çœ‹ä¸Šå»å¥½åƒå¹¶ä¸å¤æ‚ï¼Œé‚£å…·ä½“çš„å®ç°æ˜¯æ€æ ·çš„ï¼Œæœ¬æ–‡å°†å±•å¼€è®²è®²è¿™å¥—å¤œé—´æ¨¡å¼çš„å…·ä½“å®ç°~</p><p><img src="http://ww1.sinaimg.cn/large/0077b3hzgy1fuy04zlxslj30m80goguk.jpg" alt="header"></p><a id="more"></a><h4 id="æ•´ç†é¢œè‰²å€¼"><a href="#æ•´ç†é¢œè‰²å€¼" class="headerlink" title="æ•´ç†é¢œè‰²å€¼"></a>æ•´ç†é¢œè‰²å€¼</h4><p>å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚å®è·µå¤œé—´æ¨¡å¼çš„ç¬¬ä¸€æ­¥ï¼Œæ˜¯æ•´ç†åº”ç”¨å†…çš„é¢œè‰²å€¼ã€‚è¿™ç›¸å½“äºå¯¹æ•´ä¸ªåº”ç”¨å†…é¢œè‰²ä½¿ç”¨è¿›è¡Œä¸€æ¬¡å¤§æ‰«é™¤ï¼Œå¹¶å¯¹é‚£äº›ä¸ç”¨ <code>@color</code> çš„åœ°æ–¹è§„èŒƒä¸€ä¸‹ï¼Œæœ€åæŠŠæ•´ç†å‡ºæ¥çš„é¢œè‰²å€¼å’Œè®¾è®¡ç»™çš„å¤œé—´æ¨¡å¼çš„é¢œè‰²å€¼å¯¹åº”èµ·æ¥ï¼Œå°±å¯ä»¥å¾—åˆ°ä¸¤ä¸ª <code>colors.xml</code></p><p><img src="http://ww1.sinaimg.cn/large/0077b3hzgy1fuxyolfzmrj308c03sgm2.jpg" alt="colors_example"></p><p>ä½ å¯ä»¥æŠŠåŸºæœ¬çš„é¢œè‰²å€¼æ”¾åˆ° <code>base_colors.xml</code> ä¸­ï¼Œè€Œéœ€è¦å¤œé—´æ¨¡å¼çš„é¢œè‰²å€¼ä½¿ç”¨ <code>night_</code> å¼€å¤´å‘½åæ”¾è¿› <code>colors.xml</code> ä¸­ã€‚ä¸ºäº†è®©æ”¹åŠ¨æ›´å°ï¼Œä½ ä¹Ÿå¯ä»¥ç»“åˆè‡ªèº«åº”ç”¨æƒ…å†µå‘½å~</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">"night_background_white"</span>&gt;</span>@color/white<span class="tag">&lt;/<span class="name">color</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">"night_text_black"</span>&gt;</span>@color/black<span class="tag">&lt;/<span class="name">color</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å‘½åä¸º values-nightï¼ŒæŠŠå¤œé—´æ¨¡å¼ä¸­çš„é¢œè‰²å€¼æ”¾åœ¨è¿™ä¸ª <code>colors.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">"night_background_white"</span>&gt;</span>@color/black<span class="tag">&lt;/<span class="name">color</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">"night_text_black"</span>&gt;</span>@color/white<span class="tag">&lt;/<span class="name">color</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼<strong>å®ƒä»¬çš„é¢œè‰²å€¼å‘½åå¿…é¡»ç›¸åŒï¼</strong>å½“ä½ åˆ‡æ¢å¤œé—´æ¨¡å¼åï¼Œç³»ç»Ÿå°±ä¼šä½¿ç”¨ values-night ä¸­çš„é¢œè‰²å€¼æ¥æ¸²æŸ“æ–°çš„é¡µé¢~</p><p>å›¾ç‰‡èµ„æºä¹Ÿæ˜¯ä¸€æ ·çš„ï¼ŒæŠŠéœ€è¦ç”¨åˆ°çš„å¤œé—´æ¨¡å¼çš„èµ„æºæ”¾åˆ°ç›¸åº”çš„ <code>night_</code> æ–‡ä»¶å¤¹ä¸­å³å¯â€¦</p><h4 id="NightHelper"><a href="#NightHelper" class="headerlink" title="NightHelper"></a>NightHelper</h4><p>ç”±äºå®˜æ–¹çš„ API æ²¡æœ‰è·å–å½“å‰å¤œé—´æ¨¡å¼çŠ¶æ€çš„é è°±æ–¹æ³•ï¼Œæ‰€ä»¥åªèƒ½æŠŠå¤œé—´æ¨¡å¼çš„çŠ¶æ€å€¼ç”¨ <code>SharedPreference</code> æŒä¹…åŒ–å­˜å‚¨ä¸‹æ¥ã€‚ç„¶åï¼Œæˆ‘å°±å¯ä»¥åœ¨åº”ç”¨å¯åŠ¨çš„è‡ªå®šä¹‰ Application ä¸­è°ƒç”¨ <code>setDefaultNightMode(isNight)</code>  ï¼Œè®©åº”ç”¨å¯åŠ¨çš„æ—¶å€™å°±ç”¨ä¹‹å‰ä¿å­˜çš„å¤œé—´æ¨¡å¼çŠ¶æ€æ¥æ¸²æŸ“ UIã€‚</p><p>è¿™é‡Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ª <code>NightHelper</code> çš„å·¥å…·ç±»æ¥å¸®åŠ©æˆ‘æŠŠè¿™äº›æ“ä½œå°è£…èµ·æ¥ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NightHelper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">companion</span> <span class="keyword">object</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> const <span class="keyword">val</span> KEY_NIGHT_MODE = <span class="string">"key_night_mode"</span></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">isNight</span><span class="params">()</span></span>: <span class="built_in">Boolean</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> SpHelper&lt;<span class="built_in">Boolean</span>&gt;().<span class="keyword">get</span>(KEY_NIGHT_MODE, <span class="literal">false</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">setNight</span><span class="params">(isNight: <span class="type">Boolean</span>)</span></span> &#123;</span><br><span class="line">            SpHelper&lt;<span class="built_in">Boolean</span>&gt;().put(KEY_NIGHT_MODE, isNight)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">setDefaultNightMode</span><span class="params">(isNight: <span class="type">Boolean</span>)</span></span> &#123;</span><br><span class="line">            AppCompatDelegate.setDefaultNightMode(<span class="keyword">if</span> (isNight)</span><br><span class="line">                AppCompatDelegate.MODE_NIGHT_YES <span class="keyword">else</span> AppCompatDelegate.MODE_NIGHT_NO)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="setLocalNightMode"><a href="#setLocalNightMode" class="headerlink" title="setLocalNightMode"></a>setLocalNightMode</h4><p>é€šè¿‡ä¸Šé¢çŒ›å¦‚è™çš„ä¸€é¡¿æ“ä½œåï¼Œå¤œé—´æ¨¡å¼çš„æ•ˆæœåŸºæœ¬å·²ç»å®Œæˆäº† 95% ï¼Œåˆ‡æ¢çš„æ—¶å€™å¯ä»¥è¿™æ ·è°ƒç”¨</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">toggleNightMode</span><span class="params">(isNight: <span class="type">Boolean</span>)</span></span> &#123;</span><br><span class="line">    NightHelper.apply &#123;</span><br><span class="line">    setDefaultNightMode(isNight)</span><br><span class="line">    setNight(isNight)   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·ï¼Œé™¤äº† <code>MainActivity</code> è¿™ä¸ªå·²ç»å¯åŠ¨è¿‡çš„ Activity å¤–ï¼Œå…¶ä»–æ–°åˆ›å»ºçš„é¡µé¢éƒ½ä¼šä½¿ç”¨å¤œé—´æ¨¡å¼çš„é¢œè‰²å€¼æ¥åˆ›å»ºã€‚æ‰€ä»¥å‰©ä¸‹çš„ 5% å°±æ˜¯è¦è®©ã€Œæ´»ç€çš„ã€çš„é¡µé¢æµç•…åœ°åˆ‡æ¢åˆ°å¤œé—´æ¨¡å¼ã€‚å¦‚æœä½ ä»”ç»†è§‚å¯Ÿæœ‰å¤œé—´æ¨¡å¼çš„ Appï¼Œä½ ä¼šå‘ç°å®ƒä»¬å¤§éƒ¨åˆ†éƒ½æŠŠé¡µé¢æ¨¡å¼çš„å¼€å…³æ”¾åœ¨ä¸€çº§é¡µé¢ä¸­ï¼Œè¿™æ ·å°±å°±å‡å°‘äº†ã€Œæ´»ç€çš„ã€é¡µé¢çš„å¤„ç†ã€‚</p><p>æ‰€ä»¥åœ¨å®é™…ä¸šåŠ¡ä¸­ï¼Œã€Œæ´»ç€çš„ã€Activity ä¸€èˆ¬åªæœ‰ <code>MainActivity</code>ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬è¦åœ¨ AndroidMainfest ä¸­ç»™å®ƒè®¾ç½® <code>android:configChanges=&quot;uiMode&quot;</code>ï¼Œç„¶ååœ¨åˆ‡æ¢çš„æ—¶å€™ä½¿ç”¨ <code>setLocalNightMode</code>  çš„æ–¹æ³•æ¥ç»™å®ƒè®¾ç½®å¤œé—´æ¨¡å¼çŠ¶æ€ã€‚è¿™ä¸ªæ–¹æ³•å®˜æ–¹æ˜¯å»ºè®®é…åˆ <code>activity # recreate</code> ä½¿å…¶ç”Ÿæ•ˆã€‚ä½†è¿™æ ·å¯¹äºç”¨æˆ·æ¥è¯´ä½“éªŒè¾ƒå·®ï¼Œè€Œä¸”å¸‚é¢ä¸Šä¹Ÿå¾ˆå°‘åº”ç”¨ä¼šä½¿ç”¨è¿™æ ·çš„æ–¹å¼ï¼Œå› æ­¤æˆ‘ä»¬é‡‡ç”¨äº†é€’å½’åˆ·æ–° UI çš„æ–¹å¼</p><p><img src="http://ww1.sinaimg.cn/large/0077b3hzgy1fuxyolde5oj308c08cdfu.jpg" alt="show"></p><h4 id="NightView"><a href="#NightView" class="headerlink" title="NightView"></a>NightView</h4><p>é‚£ä¹ˆä¸ºäº†åˆ·æ–° UIï¼Œæˆ‘å®šä¹‰äº†æ¥å£ <code>NightView</code></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">NightView</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">resetNightColors</span><span class="params">()</span></span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">setNightCallback</span><span class="params">(callback: <span class="type">OnNightCallback</span>)</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ç€ï¼Œåˆ›å»º <code>NightTextView</code>ã€<code></code>NightFrameLayout<code>ã€</code>NightRelativeLayoutâ€¦<code>ç­‰ MainActivity ä¸­æœ‰ç”¨åˆ°çš„ Viewï¼Œè®©å®ƒä»¬å®ç°</code>NightView<code>ã€‚æ¯ä¸ª NightView éƒ½å§”æ‰˜</code>NightViewAttacher` æ¥å¤„ç†å†…éƒ¨é€»è¾‘</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NightTextView</span> <span class="keyword">constructor</span></span>(</span><br><span class="line">        context: Context, attrs: AttributeSet? = <span class="literal">null</span>, defStyleAttr: <span class="built_in">Int</span> = <span class="number">0</span></span><br><span class="line">) : AppCompatTextView(context, attrs, defStyleAttr), NightView &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> attacher = NightViewAttacher(<span class="keyword">this</span>, context, attrs)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">resetNightColors</span><span class="params">()</span></span> &#123;</span><br><span class="line">        attacher.setBackground()</span><br><span class="line">        attacher.setTextColor()</span><br><span class="line">        attacher.toggleCallback()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">setNightCallback</span><span class="params">(callback: <span class="type">OnNightCallback</span>)</span></span> &#123;</span><br><span class="line">        attacher.setNightCallback(callback)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ® View çš„ç‰¹ç‚¹åœ¨ <code>resetNightColors</code> è°ƒç”¨ç›¸åº”çš„æ–¹æ³•é‡æ–°æ¸²æŸ“è‰²å€¼ã€‚<code>setNightCallback</code> æ˜¯ä¸€ç§ç‰¹æ®Šçš„æƒ…å†µï¼Œå› ä¸ºæ¶‰åŠåˆ° <code>NightAttacher</code> çš„é€»è¾‘ï¼Œæ‰€ä»¥ä¼šåœ¨ <code>NightAttacher</code> ä¸­ä»‹ç»</p><p>çœ‹åˆ°è¿™é‡Œï¼Œä½ å¯èƒ½çœ‰å¤´ä¸€çš±ï¼šé‚£æ˜¯ä¸æ˜¯è¦æŠŠæ‰€æœ‰ MainActivity çš„ View å…¨éƒ¨æ›¿æ¢æˆ NightViewï¼Ÿå·¥ä½œé‡å¾ˆå¤§è€¶ï¼å…¶å®å¦‚æœä½ ä»¬é¡¹ç›®ä¸­çš„ xml å…¨éƒ½ä½¿ç”¨è‡ªå®šä¹‰ Viewï¼Œé‚£åªéœ€è¦è®©å®ƒä»¬å®ç° NightView æ¥å£ï¼Œå¹¶åˆ›å»º <code>NightViewAttacher</code>ï¼Œå‰©ä¸‹çš„å·¥ä½œæ¡¥æ¥ç»™å®ƒå°±è¡Œäº†ã€‚å¦‚æœä½ ä»¬ç”¨çš„æ˜¯åŸç”Ÿçš„ Viewï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ LayoutInflaterCompat # setFactory2 å¯¹ xml ä¸­çš„ View è¿›è¡Œæ›¿æ¢</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">LayoutInflaterCompat.setFactory2(layoutInflater, <span class="keyword">object</span> : LayoutInflater.Factory2 &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreateView</span><span class="params">(parent: <span class="type">View</span>, name: <span class="type">String</span>, context: <span class="type">Context</span>, attrs: <span class="type">AttributeSet</span>)</span></span>: View? &#123;</span><br><span class="line">        <span class="keyword">var</span> view: View? = <span class="literal">null</span></span><br><span class="line">       <span class="keyword">when</span> (name) &#123;</span><br><span class="line">            <span class="string">"TextView"</span> -&gt; view = NightTextView(context, attrs)</span><br><span class="line">            <span class="string">"FrameLayout"</span> -&gt; view = NightFrameLayout(context, attrs)</span><br><span class="line">            <span class="string">"RelativeLayout"</span> -&gt; view = NightRelativeLayout(context, attrs)</span><br><span class="line">                <span class="comment">// åœ¨è¿™é‡Œæ›¿æ¢ä½ éœ€è¦çš„ View</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> view ?: delegate.createView(parent, name, context, attrs)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreateView</span><span class="params">(name: <span class="type">String</span>, context: <span class="type">Context</span>, attrs: <span class="type">AttributeSet</span>)</span></span>: View?&#123;</span><br><span class="line">        <span class="keyword">return</span> onCreateView(<span class="literal">null</span>, name, context, attrs)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>ä¸è¿‡ï¼Œä»£ç é‡Œçš„åˆ›å»ºçš„ View ä½ è¿˜æ˜¯å¾—æ‰‹åŠ¨æ›¿æ¢æˆ <code>NightView</code>ï¼Œå¦‚ï¼š</p><p> <code>val textView = NightTextView(context)</code></p><h4 id="NightViewAttacher"><a href="#NightViewAttacher" class="headerlink" title="NightViewAttacher"></a>NightViewAttacher</h4><p>NightViewAttacher ä½œä¸º NightView çš„ä¸»è¦æ‰§è¡Œè€…ï¼Œè‚©ä¸Šçš„è´£ä»»å¾ˆé‡çš„~ NightView å…·ä½“çš„åˆ·æ–°å¤œé—´æ¨¡å¼æ•ˆæœéƒ½æ˜¯æ¡¥æ¥ç»™å®ƒæ¥å®ç°ã€‚é‚£ä¹ˆå®ƒç©¶ç«Ÿæ˜¯å¦‚ä½•å®Œæˆ NightView å§”æ‰˜çš„å·¥ä½œï¼Ÿ</p><p>é¦–å…ˆï¼Œå®ƒéœ€è¦ä¸€äº›åŸç”Ÿå±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ attrs æ–‡ä»¶ä¸­å¸®å®ƒå£°æ˜</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">declare-styleable</span> <span class="attr">name</span>=<span class="string">"NightView"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"android:background"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"android:textColor"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"android:tint"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">declare-styleable</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·ï¼Œå®ƒå°±å¯ä»¥åœ¨ NightViewAttacher ä¸­é€šè¿‡ <code>getResourceId</code> è·å¾—åŸç”Ÿé¢œè‰²å±æ€§~ æ³¨æ„å“¦ï¼Œè¿™ä¸ªå±æ€§æ˜¯ <code>@colorRes</code>ï¼Œè¦é€šè¿‡ <code>ContextCompat # getColor</code> ç”Ÿæˆç›¸åº”çš„è‰²å€¼ã€‚åœ¨å¤œé—´æ¨¡å¼ä¸‹ï¼Œç³»ç»Ÿä¼šä» night æ–‡ä»¶ä¸­è·å–ç›¸åº”èµ„æº</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">setTextColor</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (textColorId &gt; <span class="number">0</span> &amp;&amp; targetView <span class="keyword">is</span> TextView) &#123;</span><br><span class="line">        targetView.setTextColor(ContextCompat.getColor(context, textColorId))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œå¦‚æœæ˜¯é€šè¿‡ <code>TypeArray # getColor</code> æ‹¿åˆ°çš„è‰²å€¼ä¸ä¼šæ ¹æ®å¤œé—´æ¨¡å¼çš„çŠ¶æ€å»åˆ‡æ¢ä¸åŒè‰²å€¼ï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™æ‹¿åˆ°çš„é¢œè‰²å€¼å·²ç»æ˜¯ <code>@colorId</code>ï¼Œ å°±æ— æ³•æ ¹æ®å½“å‰çš„æ¨¡å¼æ¥æ˜¾ç¤ºç›¸åº”è‰²å€¼</p><p>åœ¨ NightAttacher ä¸­ï¼Œæˆ‘ä»¬åªèƒ½è·å¾— xml ä¸­å®šä¹‰çš„è‰²å€¼ã€‚å¦‚æœæ˜¯åœ¨ä»£ç ä¸­è®¾ç½®çš„é¢œè‰²ï¼Œå°±ä¼šå¯¼è‡´åˆ‡æ¢çš„æ—¶å€™æ— æ³•æ‹¿åˆ°è‰²å€¼æ¥é‡æ–°æ¸²æŸ“ã€‚åŸºäºè¿™ä¸ªåŸå› ï¼Œæˆ‘ä»¬å®šä¹‰äº† <code>setNightCallback</code> çš„æ–¹æ³•ï¼ŒæŠŠè®¾ç½®é¢œè‰²çš„æ–¹æ³•æ”¾åˆ° callback å†…éƒ¨åšã€‚åœ¨ <code>NightView # resetNightColors</code> ä¸­æŠŠ callback ä¸­çš„æ–¹æ³•å†æ‰§è¡Œä¸€éï¼Œè¾¾åˆ°é‡æ–° UI æ•ˆæœ</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">setNightCallback</span><span class="params">(callback: <span class="type">OnNightCallback</span>?)</span></span> &#123;</span><br><span class="line">    callback?.apply &#123;</span><br><span class="line">        call()</span><br><span class="line">        callbackList.add(<span class="keyword">this</span>) </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">toggleCallback</span><span class="params">()</span></span> &#123;</span><br><span class="line">    callbackList.forEach &#123; it.call() &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå†…éƒ¨çš„å®ç°æ— éå°±æ˜¯æŠŠ callback ç¼“å­˜èµ·æ¥ï¼Œç„¶ååœ¨ <code>toggleCallback</code> ä¸­æ‰§è¡Œï¼Œè€Œ <code>toogleCallback</code> ä¼šåœ¨ <code>NightView # resetNightColors</code> ä¸­è¢«è°ƒç”¨ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ <code>setNightCallback</code> çš„ callback ä¼šåœ¨è®¾ç½®è¿›å»çš„æ—¶å€™è°ƒç”¨ä¸€æ¬¡ï¼Œä¾¿äºæ›¿æ¢å¤–éƒ¨çš„æ–¹æ³•</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŠ å…¥å¤œé—´æ¨¡å¼å‰</span></span><br><span class="line"><span class="keyword">val</span> textView = TextView(context)</span><br><span class="line">textView.setTextColor(ContextCompat.getColor(context, R.color.night_white))</span><br><span class="line"><span class="comment">// åŠ å…¥å¤œé—´æ¨¡å¼å</span></span><br><span class="line"><span class="keyword">val</span> textView = NightTextView(<span class="keyword">this</span>)</span><br><span class="line">textView.setNightCallback(<span class="keyword">object</span> : OnNightCallback&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">call</span><span class="params">()</span></span> &#123;</span><br><span class="line">        textView.setTextColor(ContextCompat.getColor(context, R.color.night_white))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>åŠ å…¥å¤œé—´æ¨¡å¼åï¼Œ<code>MainActivity</code> ä¸­åœ¨ä»£ç ä¸­è®¾ç½®é¢œè‰²çš„æ–¹æ³•è¢«æŒªåˆ° <code>setNightCallback</code> çš„å›è°ƒä¸­æ‰§è¡Œï¼Œå› ä¸º setNightCallback çš„å›è°ƒé»˜è®¤ä¼šè°ƒç”¨ä¸€æ¬¡ï¼Œå¤–éƒ¨è°ƒç”¨è€…ä½¿ç”¨èµ·æ¥å°±æ›´æ–¹ä¾¿äº†~ è¿™é‡Œå†å¼ºè°ƒä¸€éï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰ä»£ç é‡Œè®¾ç½®é¢œè‰²çš„æ–¹æ³•éƒ½ç”¨ <code>setNightCallback</code>ï¼Œåªæœ‰åˆ‡æ¢æ—¶å¯åŠ¨ç€çš„ <code>MainActivity</code> æ‰éœ€è¦å“¦~</p><h4 id="resetView"><a href="#resetView" class="headerlink" title="resetView"></a>resetView</h4><p>NightView å·²ç»å‡†å¤‡å¥½äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦åœ¨åˆ‡æ¢å¤œé—´æ¨¡å¼çš„æ—¶å€™ä½¿ç”¨å®ƒäº†~ </p><p>å¦‚æœä½¿ç”¨äº† NoActionBar çš„ä¸»é¢˜ï¼Œå¯ä»¥é€šè¿‡ <code>getRootView</code> æ¥è·å–æ ¹ View</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">getRootView</span><span class="params">()</span></span>: View &#123;</span><br><span class="line">    <span class="keyword">return</span> window.decorView.findViewById(android.R.id.content)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ‡æ¢å¤œé—´æ¨¡å¼æ—¶ï¼Œå¯¹ rootView è¿›è¡Œé€’å½’éå†ï¼Œè®©ä¸»é¡µé¢æ‰€æœ‰å…ƒç´ é‡æ–°æ¸²æŸ“</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">resetView</span><span class="params">(view: <span class="type">View</span>)</span></span> &#123;</span><br><span class="line">     view.apply &#123;</span><br><span class="line">         <span class="keyword">if</span> (<span class="keyword">this</span> <span class="keyword">is</span> NightView) &#123;</span><br><span class="line">             resetNightColors()</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">if</span> (<span class="keyword">this</span> <span class="keyword">is</span> ViewGroup) &#123;</span><br><span class="line">             <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">0</span> until childCount) &#123;</span><br><span class="line">               resetView(getChildAt(i))</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¯ä¸ªè¢«éå†åˆ°çš„ view å¦‚æœå®ç°äº† <code>NightView</code> æ¥å£ï¼Œé‚£ä¹ˆå°±æ‰§è¡Œå®ƒçš„ <code>resetNightColors</code> é‡æ–°æ¸²æŸ“ UIï¼›å¦‚æœ view æ˜¯ ViewGroup ï¼Œé‚£ä¹ˆå¯¹å®ƒçš„å­ View è¿›è¡Œéå†æ‰§è¡Œ resetViewï¼Œé€’å½’ä¸‹å»å°±å¯ä»¥æŠŠæ‰€æœ‰ view çš„è‰²å€¼éƒ½é‡ç½®å•¦~</p><h4 id="RecyclerView"><a href="#RecyclerView" class="headerlink" title="RecyclerView"></a>RecyclerView</h4><p>ä¸Šæ–‡æåŠï¼Œå› ä¸º RecyclerView å¸ƒå±€å¤ç”¨çš„åŸå› ï¼ŒresetView ä¼šæ¼æ‰å¤ç”¨çš„å¸ƒå±€ã€‚ItemView ä¸å¯è§å´ç¼“å­˜åœ¨ RecyclerView çš„å†…å­˜ä¸­ï¼Œæ‰€ä»¥å®ƒä»¬çš„å¸ƒå±€åœ¨åˆ‡æ¢å¤œé—´æ¨¡å¼çš„æ—¶å€™ä¸ä¼šè¢«é‡æ–°æ¸²æŸ“ï¼Œè¿™å¯¼è‡´ RecyclerView ä¼šåœ¨æ»šåŠ¨çš„æ—¶å€™å¤ç”¨åŸå…ˆçš„æ²¡è¢«é‡æ–°æ¸²æŸ“æ–°è‰²å€¼çš„å¸ƒå±€ï¼Œæœ€ç»ˆå¯¼è‡´äº†é¡µé¢å¼‚å¸¸</p><p>è§£å†³çš„æ–¹æ³•æ˜¯æŠŠ RecyclerView ä¸­ç¼“å­˜çš„å¸ƒå±€æ¸…ç©ºæ‰ï¼Œè®© RecyclerView æ»šåŠ¨æ—¶é‡æ–°åˆ›å»ºå¸ƒå±€æˆ–è€…å¤ç”¨å·²ç»è¢«é‡æ–°æ¸²æŸ“å¥½çš„å¸ƒå±€</p><p>åˆ›å»º <code>NightRecyclerView</code> ç»§æ‰¿ RecyclerView å¹¶å®ç° NightViewï¼Œåœ¨ NightView çš„ resetNightColors ä¸­é€šè¿‡åå°„è°ƒç”¨ RecyclerView çš„ <code>mRecycler # clear</code>  æ¥æŠŠç¼“å­˜å¸ƒå±€æ¸…æ‰</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">resetNightColors</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">val</span> declaredField = javaClass.getDeclaredField (<span class="string">"mRecycler"</span>)</span><br><span class="line">        declaredField.isAccessible = <span class="literal">true</span></span><br><span class="line">        <span class="keyword">val</span> declaredMethod = Class.forName(RecyclerView.Recycler::<span class="class"><span class="keyword">class</span>.<span class="title">java</span>.<span class="title">name</span>)</span></span><br><span class="line">                .getDeclaredMethod(<span class="string">"clear"</span>, *arrayOfNulls&lt;Class&lt;*&gt;&gt;(<span class="number">0</span>) <span class="keyword">as</span> Array&lt;Class&lt;*&gt;&gt;)</span><br><span class="line">        declaredMethod.isAccessible = <span class="literal">true</span></span><br><span class="line">        declaredMethod.invoke(declaredField.<span class="keyword">get</span>(<span class="keyword">this</span>), arrayOfNulls&lt;Any&gt;(<span class="number">0</span>))</span><br><span class="line">        recycledViewPool.clear()</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e: Exception) &#123;</span><br><span class="line">        e.printStackTrace()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç¦ç”¨å¤œé—´æ¨¡å¼"><a href="#ç¦ç”¨å¤œé—´æ¨¡å¼" class="headerlink" title="ç¦ç”¨å¤œé—´æ¨¡å¼"></a>ç¦ç”¨å¤œé—´æ¨¡å¼</h4><p>å½“æˆ‘ä»¬å®ç°å®Œè¿™äº›åï¼ŒåŸºæœ¬ä¸Šå¤œé—´æ¨¡å¼çš„æ•ˆæœå°±å®Œæˆäº†~ è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±ä¼šæƒ³ï¼Œå¯èƒ½ä¼šå‡ºç°ä¸€äº›é¡µé¢æ ¹æœ¬ä¸éœ€è¦å¤œé—´æ¨¡å¼ï¼Œé‚£ä¹ˆé’ˆå¯¹è¿™äº›é¡µé¢æˆ‘ä»¬ä¹Ÿè¦åšç‰¹æ®Šå¤„ç†ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å®šä¹‰äº† <code>DisableNight</code> çš„æ¥å£ï¼Œè®©ä¸éœ€è¦å¤œé—´æ¨¡å¼çš„é¡µé¢å®ç°è¿™ä¸ªæ¥å£ã€‚ç„¶ååˆ¤æ–­ï¼Œå¦‚æœé¡µé¢æ˜¯ <code>DisableNight</code>ï¼Œå°±åœ¨é¡µé¢å¯è§æ—¶è°ƒç”¨ <code>setLocalNightMode</code> è®¾ç½®æ—¥é—´æ¨¡å¼ï¼Œå¤œé—´ä¸å¯è§æ—¶è®¾ç½®å›å¤œé—´æ¨¡å¼ã€‚è¿™çœ‹ä¼¼ç¨³å¾—ä¸€åŒ¹ï¼Œä½†å…¶å®åŒ…å«äº†ä¸€ä¸ª BUG â€”â€” <code>setLocalNightMode</code> ä¼šå½±å“æ‰€æœ‰ã€Œæ´»ç€çš„ã€é¡µé¢ã€‚å‡å¦‚ A é¡µé¢åœ¨è¯·æ±‚æ•°æ®ï¼Œè¿™æ—¶å®ƒè·³è½¬åˆ°äº†ä¸éœ€è¦å¤œé—´æ¨¡å¼çš„ Bï¼ŒB æŠŠå¤œé—´æ¨¡å¼è®¾ç½®æˆäº†æ—¥é—´å½±å“äº† Aï¼Œè¿™æ—¶æ‰è¿”å›çš„æ•°æ®æ¸²æŸ“å‡ºæ¥çš„ UI å°±ä¼šå˜æˆæ—¥é—´æ¨¡å¼</p><p><img src="http://ww1.sinaimg.cn/large/0077b3hzgy1fuxyolfp4fj305k04qwep.jpg" alt="sad"></p><p>é‚£ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œåˆå¾—å¦‚ä½•è§£å†³ï¼Œæˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡<a href="http://wenqin231.com/2018/08/09/%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%B4%A2%E2%80%94%E2%80%94%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" target="_blank" rel="noopener">ã€Œå¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”æºç åˆ†æã€</a>ä¸­ä¸€æ¢ç©¶ç«Ÿ~</p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>é€šè¿‡ä¸Šæ–‡åˆ†æï¼Œæˆ‘ç›¸ä¿¡ä½ å¯¹å¤œé—´æ¨¡å¼çš„å®ç°å·²ç»æœ‰äº†åˆæ­¥çš„è®¤è¯†ï¼Œä½†æœ‰ä¸¤ä¸ªæ–¹é¢éœ€è¦ç†è§£æ¸…æ¥š</p><p>ç¬¬ä¸€ï¼Œå¤œé—´æ¨¡å¼çš„å…·ä½“æ•ˆæœä¸éš¾å®ç°ï¼Œé€šè¿‡ <code>setDefaultNightMode</code> å°±å¯ä»¥è½»æ¾å®ç°ã€‚ç¹ççš„å·¥ä½œåœ¨äºåˆ‡æ¢å¤œé—´æ¨¡å¼æ—¶ï¼Œè¦æŠŠå½“å‰çš„ MainActivity ä¸­çš„ UI é‡æ–°æ¸²æŸ“ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æŠŠ MainActivity ä¸­çš„ View å…¨éƒ¨æ›¿æ¢æˆ NightViewï¼Œç„¶åé€’å½’éå†ã€‚è€Œå¯¹äºç‰¹æ®Šçš„ RecyclerViewï¼Œåˆ™éœ€è¦æŠŠå®ƒå†…éƒ¨ç¼“å­˜çš„å¸ƒå±€æ¸…ç©ºæ‰</p><p>ç¬¬äºŒï¼Œæ‰€æœ‰ View æ‹¿åˆ°çš„ <code>colorId</code> å€¼éƒ½æ˜¯16è¿›åˆ¶çš„æ•°å­—ï¼Œå®ƒä¸ä¼šå› ä¸ºå¤œé—´æ¨¡å¼çš„æ”¹å˜è€Œæ”¹å˜ï¼Œè€Œå¦‚æœæ‹¿åˆ°å®ƒä»¬çš„ <code>colorRes</code>ï¼Œå°±å¯ä»¥è®© <code>ContextCompat # getColor</code> æ ¹æ®å¤œé—´æ¨¡å¼çš„çŠ¶æ€å»æ‹¿ä¸åŒèµ„æºçš„è‰²å€¼</p><h4 id="å¤œé—´æ¨¡å¼ç³»åˆ—æ–‡ç« "><a href="#å¤œé—´æ¨¡å¼ç³»åˆ—æ–‡ç« " class="headerlink" title="å¤œé—´æ¨¡å¼ç³»åˆ—æ–‡ç« "></a>å¤œé—´æ¨¡å¼ç³»åˆ—æ–‡ç« </h4><p><a href="http://wenqin231.com/2018/06/19/%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%B4%A2%E2%80%94%E2%80%94%E5%BC%80%E7%AF%87/" target="_blank" rel="noopener">å¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”å¼€ç¯‡</a></p><p><a href="http://wenqin231.com/2018/08/08/%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%B4%A2%E2%80%94%E2%80%94%E5%B1%95%E5%BC%80%E8%AE%B2%E8%AE%B2/" target="_blank" rel="noopener">å¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”å±•å¼€è®²è®²</a></p><p><a href="">å¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”æºç åˆ†æ</a></p><p><a href="http://wenqin231.com/2018/08/09/%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%B4%A2%E2%80%94%E2%80%94QA/" target="_blank" rel="noopener">å¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”QA</a></p><p><em>å‚è€ƒèµ„æ–™</em></p><p><a href="https://medium.com/androiddevelopers/appcompat-v23-2-daynight-d10f90c83e94" target="_blank" rel="noopener">AppCompatâ€Šâ€”â€ŠDayNight</a></p><p><a href="https://www.jianshu.com/p/3b55e84742e5" target="_blank" rel="noopener">çŸ¥ä¹å’Œç®€ä¹¦çš„å¤œé—´æ¨¡å¼å®ç°å¥—è·¯</a></p><p><strong>æ¬¢è¿å¤§å®¶æ¥å³åˆ»æ‰¾æˆ‘ç©</strong></p><p><img src="http://ww1.sinaimg.cn/large/0077b3hzgy1fuxyhhcjfcj309e0goaaw.jpg" alt="jike"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ‰¿æ¥ä¸Šæ–‡ï¼Œä½¿ç”¨ &lt;code&gt;setDefaultNightMode&lt;/code&gt; æ¥è®¾ç½®å…¨å±€çš„æ—¥å¤œé—´æ¨¡å¼ï¼Œä½†å®ƒå¯¹å¯åŠ¨è¿‡çš„ Activity æ— æ•ˆï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—ä½¿ç”¨ &lt;code&gt;setLocalNightMode&lt;/code&gt; è®¾ç½®å¯åŠ¨ç€çš„ Activity çš„å¤œé—´æ¨¡å¼ï¼Œå†å¯¹å¸ƒå±€å†…çš„ View é‡æ–°æ¸²æŸ“é¢œè‰²å€¼æ¥åˆ‡æ¢å¤œé—´æ¨¡å¼ã€‚è¿™çœ‹ä¸Šå»å¥½åƒå¹¶ä¸å¤æ‚ï¼Œé‚£å…·ä½“çš„å®ç°æ˜¯æ€æ ·çš„ï¼Œæœ¬æ–‡å°†å±•å¼€è®²è®²è¿™å¥—å¤œé—´æ¨¡å¼çš„å…·ä½“å®ç°~&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://ww1.sinaimg.cn/large/0077b3hzgy1fuy04zlxslj30m80goguk.jpg&quot; alt=&quot;header&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>å¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”å¼€ç¯‡</title>
    <link href="http://yoursite.com/2018/06/19/%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%B4%A2%E2%80%94%E2%80%94%E5%BC%80%E7%AF%87/"/>
    <id>http://yoursite.com/2018/06/19/å¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”å¼€ç¯‡/</id>
    <published>2018-06-19T02:25:10.000Z</published>
    <updated>2018-09-04T18:09:06.000Z</updated>
    
    <content type="html"><![CDATA[<p>2018å¹´1æœˆï¼ŒYoutube å¯¹ ios å®¢æˆ·ç«¯ç°åº¦å‘å¸ƒå¤œé—´æ¨¡å¼ï¼›2018 WWDC ä¸Šï¼ŒMac OS æ·»åŠ äº†ç³»ç»Ÿçº§çš„å¤œé—´æ¨¡å¼åŠŸèƒ½ï¼Œå¯¹åº”ç”¨è¿›è¡Œå¤œé—´é€‚é…ï¼›18å¹´7æœˆï¼ŒYoutube å¯¹ Android å®¢æˆ·ç«¯ç°åº¦å‘å¸ƒäº†å¤œé—´æ¨¡å¼â€¦â€¦ è€Œåœ¨å›½å†…ï¼Œæ—©æœ‰ä¸€æ‰¹åº”ç”¨æ·»åŠ äº†å®ƒä»¬çš„å¤œé—´æ¨¡å¼ï¼Œé‚£ä¹ˆä½ çš„åº”ç”¨æ˜¯å¦éœ€è¦å¤œé—´æ¨¡å¼ï¼Œåˆè¯¥å¦‚ä½•é€‚é…å‘¢ï¼Ÿ æœ¬æ–‡å°†ä»åº”ç”¨éœ€æ±‚å’Œ Android å®ç°æ–¹æ¡ˆä¸¤ä¸ªè§’åº¦ç®€è¦è®²è¿°~</p><p><img src="http://ww1.sinaimg.cn/large/0077b3hzgy1fuxw63tnxnj33c01pb1kx.jpg" alt="night_example"></p><a id="more"></a><h4 id="åº”ç”¨éœ€æ±‚"><a href="#åº”ç”¨éœ€æ±‚" class="headerlink" title="åº”ç”¨éœ€æ±‚"></a>åº”ç”¨éœ€æ±‚</h4><p><strong>ä»åº”ç”¨äº§å“çš„è§’åº¦æ¥çœ‹</strong></p><ul><li>ç”¨æˆ·æœ‰æ²¡æœ‰å¯èƒ½åœ¨å¤œé—´é«˜é¢‘åœ°ä½¿ç”¨ä½ çš„åº”ç”¨ï¼Ÿ</li><li>ä½ çš„åº”ç”¨æœ¬èº«çš„é…è‰²æ˜¯å¦åäº®ç³»ï¼Ÿ</li><li>åé¦ˆè¿™ä¸ªéœ€æ±‚çš„ç”¨æˆ·æ•°å æ¯”é«˜ä¹ˆï¼Ÿ<ul><li>å‡å¦‚è¿™ä¸ªå æ¯”å¾ˆä½çš„è¯ï¼Œé‚£ä¹ˆå›¢é˜Ÿå¯èƒ½éœ€è¦æŠŠæ›´å¤šçš„æ—¶é—´èŠ±åœ¨å…¶ä»–éœ€æ±‚ä¸Š</li></ul></li></ul><p><strong>ä»è®¾è®¡å¸ˆçš„è§’åº¦æ¥çœ‹</strong></p><ul><li>è®¾è®¡å¸ˆå›¢é˜Ÿæ˜¯å¦èƒ½å¤Ÿæä¾›ä¸€ä»½åˆé€‚çš„è®¾è®¡ï¼Ÿ<ul><li>è®¾è®¡å¸ˆå°†å†³å®šäº†åº”ç”¨å¤œæ™šçš„æ¨¡æ ·ï¼Œå¾ˆå¤šç»†èŠ‚éƒ½è¦ä»–æ¥ç¡®å®š</li></ul></li></ul><p><strong>ä»å·¥ç¨‹å¸ˆçš„è§’åº¦æ¥çœ‹</strong></p><ul><li>å°½å¯èƒ½åœ°è®©å¤œé—´æ•ˆæœè¦†ç›–æ‰€æœ‰çš„é¡µé¢ï¼Œè€Œä¸”åˆ‡æ¢æ•ˆæœè¦æµç•…è‡ªç„¶</li><li>å¯¹åŸæœ‰ä»£ç çš„å…¥ä¾µæ€§ä½ï¼Œæ›´å°‘åœ°ä»£ç æ”¹åŠ¨</li><li>å°½é‡é¿å…ä¾µå…¥ä¸šåŠ¡ï¼Œå³å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œä¸šåŠ¡å¼€å‘ä¸éœ€è¦å…³å¿ƒå¤œé—´æ¨¡å¼</li></ul><p>ä¸Šé¢çš„ä¸‰å±‚å…¶å®æœ‰ç‚¹é€’è¿›çš„æ„æ€ï¼Œå…¶å®åšåˆ°ç¬¬ä¸€ç‚¹ï¼Œå·¥ä½œå°±ç®—å®Œæˆäº†ã€‚ä½†æ˜¯å¦‚æœè€ƒè™‘åˆ°å¯ç»´æŠ¤æ€§å’Œâ€œäººèº«å®‰å…¨â€ï¼Œæ¥ä¸‹æ¥çš„ä¸¤ç‚¹è¿˜æ˜¯å¾ˆé‡è¦çš„ï¼é‚£ä¹ˆï¼Œå°±è®©æˆ‘æ¥è·Ÿå¤§å®¶èŠèŠå¤œé—´æ¨¡å¼ Android çš„å®ç°ï¼Œè‡³äº web å‰ç«¯å’Œ ios â€¦â€¦</p><p><img src="http://ww1.sinaimg.cn/large/0077b3hzgy1fuxwbatd0pj305k05kmxd.jpg" alt="oh_no"></p><h4 id="Android-å®è·µæ€è·¯"><a href="#Android-å®è·µæ€è·¯" class="headerlink" title="Android å®è·µæ€è·¯"></a>Android å®è·µæ€è·¯</h4><p>å°±æˆ‘æ‰€çŸ¥ï¼Œç›®å‰ Android ç«¯å®ç°å¤œé—´æ¨¡å¼æœ‰ä¸‰ç§æ–¹å¼ï¼š</p><ol><li>Google çš„åŸç”Ÿæ”¯æŒ</li><li>è‡ªå®šä¹‰ Android ä¸»é¢˜</li><li>æ¢è‚¤</li></ol><p>Android åŸç”Ÿè‡ªå¸¦äº†å¤œé—´æ¨¡å¼çš„ APIï¼Œå¯ä»¥è®©<strong>æ–°åˆ›å»ºçš„é¡µé¢</strong>ä½¿ç”¨é…ç½®å¥½çš„å¤œé—´é¢œè‰²å€¼</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">setDefaultNihgtMode</span><span class="params">(isNight: <span class="type">Boolean</span>)</span></span> &#123;</span><br><span class="line">       AppCompatDelegate.setDefaultNightMode(<span class="keyword">if</span> (isNight) </span><br><span class="line">           AppCompatDelegate.MODE_NIGHT_YES <span class="keyword">else</span> AppCompatDelegate.MODE_NIGHT_NO)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€Œå¯¹äºå·²ç»å¯åŠ¨å¥½çš„é¡µé¢åˆ™å¯ä»¥è°ƒç”¨</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">setLocalNightMode</span><span class="params">(activity: <span class="type">AppCompatActivity</span>, isNight: <span class="type">Boolean</span>)</span></span> &#123;</span><br><span class="line">    activity.delegate.setLocalNightMode(<span class="keyword">if</span> (isNight) </span><br><span class="line">        AppCompatDelegate.MODE_NIGHT_YES <span class="keyword">else</span> AppCompatDelegate.MODE_NIGHT_NO)</span><br><span class="line">    activity.recreate()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼éœ€è¦ <code>setLocalNightMode</code> çš„ Activity åœ¨ AndroidManifest ä¸­è¦è®¾ç½® <code>android:configChanges=&quot;uiMode&quot;</code>ï¼Œå¦åˆ™æ— æ³•ç”Ÿæ•ˆ~</p><p>è¿™ä¸ªæ–¹æ¡ˆå› ä¸ºé¡µé¢è¦é‡æ–°å¯åŠ¨ï¼Œæ‰€ä»¥å®é™…æ•ˆæœè¿˜è¾¾ä¸åˆ°äº§å“çš„è¦æ±‚â€¦â€¦</p><p><img src="http://ww1.sinaimg.cn/large/0077b3hzgy1fuxwbbqxxpj308c089wie.jpg" alt="udontwant"></p><p>ç¬¬äºŒç§æ–¹æ¡ˆæ˜¯é€šè¿‡æ”¹å˜ä¸»é¢˜çš„æ–¹å¼æ¥è®©åº”ç”¨ä½¿ç”¨ä¸åŒä¸»é¢˜ä¸‹çš„é¢œè‰²å€¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ—¥é—´ä¸»é¢˜ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"AppTheme"</span> <span class="attr">parent</span>=<span class="string">"Theme.AppCompat.Light.DarkActionBar"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorPrimary"</span>&gt;</span>@color/colorPrimary<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorPrimaryDark"</span>&gt;</span>@color/colorPrimaryDark<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorAccent"</span>&gt;</span>@color/colorAccent<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorBackground"</span>&gt;</span>@color/white<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="undefined">    ...</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å¤œé—´ä¸»é¢˜ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"NightAppTheme"</span> <span class="attr">parent</span>=<span class="string">"Theme.AppCompat.Light.DarkActionBar"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorPrimary"</span>&gt;</span>@color/colorPrimaryNihgt<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorPrimaryDark"</span>&gt;</span>@color/colorPrimaryDarkNight<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorAccent"</span>&gt;</span>@color/colorAccentNight<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorBackground"</span>&gt;</span>@color/gray<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="undefined">    ...</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œéœ€è¦å®šä¹‰ä¸¤ä¸ªå‘½åä¸€æ ·çš„é¢œè‰²åï¼Œåœ¨ä¸¤ç§ä¸»é¢˜ä¸‹ä½¿ç”¨ä¸åŒçš„é¢œè‰²å€¼ï¼Œåœ¨ä¸åŒçš„ä¸»é¢˜ä¸‹å¼•ç”¨ç›¸åº”çš„è‰²å€¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">"?attr/colorAccent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">"@color/colorAccent"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸è¿‡é¢œè‰²çš„ä½¿ç”¨æ–¹å¼è¦ä» <code>@color</code> å˜æˆäº† <code>?attr</code>ï¼Œä¾‹å¦‚ä¸Šé¢çš„ <code>LinearLayout</code> çš„èƒŒæ™¯è‰²åˆ‡æ¢äº†å¤œé—´æ¨¡å¼åå°±å¯ä»¥ä½¿ç”¨å…¶ä»–é¢œè‰²ï¼Œè€Œ <code>TextView</code> çš„å­—ä½“é¢œè‰²è¿˜æ˜¯åŸæ¥çš„é¢œè‰²</p><p>å¦‚æœè¦æŠŠé¡¹ç›®ä¸­çš„æ‰€æœ‰é¢œè‰²å€¼çš„å¼•ç”¨æ–¹å¼éƒ½é€ä¸€æ›¿æ¢ï¼Œé‚£ä¹ˆå·¥ç¨‹é‡å¤ªå¤§äº†ï¼Œè¿™ä¸æˆ‘ä»¬ä¹‹å‰è¯´çš„ç¬¬äºŒç‚¹å’Œç¬¬ä¸‰ç‚¹å†²çª</p><p>ç¬¬ä¸‰ç§æ–¹å¼æ˜¯æ¢è‚¤æ–¹æ¡ˆï¼Œé€šè¿‡åŠ¨æ€æ›´æ¢ Resources æ¥è¾¾åˆ°å¤œé—´æ•ˆæœï¼Œè¿™ä¸ªæ–¹æ¡ˆå®ç°å’Œç»´æŠ¤æˆæœ¬è¾ƒå¤§ã€‚å¦‚æœæœ‰å¤šä¸»é¢˜æ ·å¼ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨è¯¥æ–¹æ¡ˆï¼Œä½†æ˜¯å¦‚æœåªæ˜¯ä¸ºäº†å®ç°å¤œé—´æ¨¡å¼æ¥è¯´ï¼Œä¸æ˜¯å¾ˆå€¼å¾—</p><p>éš¾é“å°±æ²¡æœ‰ä¸€ä¸ªå®Œç¾çš„æ–¹æ¡ˆæ¥å®ç°å¤œé—´æ¨¡å¼äº†ä¹ˆï¼Ÿè¿™ä¸ªè¿˜çœŸæ²¡æœ‰ï¼</p><p><img src="http://ww1.sinaimg.cn/large/0077b3hzgy1fuxwqf55p6j305k05fjrk.jpg" alt="tried"></p><p>ä¸è¿‡ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ç¬¬ä¸€ç§æ–¹æ¡ˆçš„é‡å¯é¡µé¢è¿›è¡Œä¼˜åŒ–ï¼Œè®©é¡µé¢é‡å¯å˜ä¸ºé¡µé¢åˆ·æ–°ï¼ŒåŠ ä¸Šä¸€ç‚¹ç‚¹åŠ¨ç”»ï¼Œå¤œé—´æ¨¡å¼çš„åˆ‡æ¢ç«‹é©¬å˜å¾—ä¼˜é›…èµ·æ¥äº†å‘¢~</p><p>åœ¨ Android ä¸­å¯ä»¥åˆ©ç”¨ <code>LayoutInflaterFactory</code> æ¥æ›¿æ¢ xml çš„æ§ä»¶ï¼ŒæŠŠåŸç”Ÿæ§ä»¶æ›¿æ¢æˆè‡ªå®šä¹‰æ§ä»¶ã€‚ç„¶åæˆ‘ä»¬å¯¹æ‰€æœ‰ã€Œæ´»ç€çš„ã€çš„ View é€’å½’è°ƒç”¨è‡ªå®šä¹‰æ§ä»¶ä¸­å°è£…å¥½çš„åˆ·æ–° UI çš„æ–¹æ³•ï¼Œå°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜â€¦</p><p><img src="http://ww1.sinaimg.cn/large/0077b3hzgy1fuxwtu3sn9j306y06yglq.jpg" alt="much_happy"></p><p>å®ç°æ€è·¯å·²ç»ç¡®å®šäº†ï¼Œæ¥ä¸‹æ¥æ¥çœ‹çœ‹ç»†èŠ‚çš„å®ç°ã€‚å¯¹äº RecyclerView åˆ—è¡¨æ¥è¯´ï¼Œå¸ƒå±€æ˜¯å¤ç”¨çš„ï¼Œä¹Ÿå°±æ˜¯é‚£äº›æ²¡æœ‰è¢«é‡æ–°åˆ·æ–°çš„å¤ç”¨å¸ƒå±€ï¼Œå®ƒä»¬çš„é¢œè‰²çŠ¶æ€ä¼šå½±å“åˆ°æ–°åˆ›å»ºçš„é¡µé¢ï¼›ä¸Šé¢çš„æ–¹æ¡ˆæ˜¯é’ˆå¯¹ xml å¼•ç”¨çš„é¢œè‰²å€¼ï¼Œé‚£ä¹ˆä»£ç ä¸­å¼•ç”¨çš„é¢œè‰²å€¼ï¼Œæˆ‘ä»¬åˆè¯¥å¦‚ä½•å¤„ç†ï¼›æ›´å¤šå…·ä½“çš„ç»†èŠ‚å®ç°ä¼šåœ¨<a href="http://wenqin231.com/2018/08/08/%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%B4%A2%E2%80%94%E2%80%94%E5%B1%95%E5%BC%80%E8%AE%B2%E8%AE%B2/" target="_blank" rel="noopener">ã€ŒAndroid å¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”å±•å¼€è®²è®²ã€</a>ä¸­è®²è¿°</p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>éšç€ç°åœ¨è¶Šæ¥è¶Šå¤šåº”ç”¨é‡è§†å¤œé—´æ¨¡å¼ï¼Œå¦‚æœç”¨æˆ·å¯¹ä½ çš„åº”ç”¨æœ‰å¤œé—´æ¨¡å¼çš„æœŸå¾…å¹¶ä¸”è®¾è®¡å¸ˆæœ‰ç›¸åº”çš„è®¾è®¡ï¼Œé‚£ä¹ˆå¤œé—´æ¨¡å¼è¿˜æ˜¯å¾ˆå€¼å¾—å°è¯•çš„ã€‚è™½ç„¶ç›®å‰æ²¡æœ‰ä¸€å¥—å®Œå–„çš„æ–¹æ¡ˆï¼ŒåŸç”Ÿçš„ API ä¹Ÿä¸æ˜¯ç‰¹åˆ«å‹å¥½ï¼Œä½†æ˜¯é€šè¿‡é€’å½’åˆ·æ–°æ§ä»¶çš„æ–¹å¼å¤§ä½“ä¸Šæ•ˆæœè¿˜æ˜¯ä»¤äººæ»¡æ„çš„~</p><h4 id="å¤œé—´æ¨¡å¼ç³»åˆ—æ–‡ç« "><a href="#å¤œé—´æ¨¡å¼ç³»åˆ—æ–‡ç« " class="headerlink" title="å¤œé—´æ¨¡å¼ç³»åˆ—æ–‡ç« "></a>å¤œé—´æ¨¡å¼ç³»åˆ—æ–‡ç« </h4><p><a href="http://wenqin231.com/2018/06/19/%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%B4%A2%E2%80%94%E2%80%94%E5%BC%80%E7%AF%87/" target="_blank" rel="noopener">å¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”å¼€ç¯‡</a></p><p><a href="http://wenqin231.com/2018/08/08/%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%B4%A2%E2%80%94%E2%80%94%E5%B1%95%E5%BC%80%E8%AE%B2%E8%AE%B2/" target="_blank" rel="noopener">å¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”å±•å¼€è®²è®²</a></p><p><a href="">å¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”æºç åˆ†æ</a></p><p><a href="http://wenqin231.com/2018/08/09/%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%B4%A2%E2%80%94%E2%80%94QA/" target="_blank" rel="noopener">å¤œé—´æ¨¡å¼å®è·µæ¢ç´¢â€”â€”QA</a></p><p><em>å‚è€ƒèµ„æ–™</em></p><p><a href="https://medium.com/androiddevelopers/appcompat-v23-2-daynight-d10f90c83e94" target="_blank" rel="noopener">AppCompatâ€Šâ€”â€ŠDayNight</a></p><p><a href="https://www.jianshu.com/p/3b55e84742e5" target="_blank" rel="noopener">çŸ¥ä¹å’Œç®€ä¹¦çš„å¤œé—´æ¨¡å¼å®ç°å¥—è·¯</a></p><p><a href="https://www.uisdc.com/tencent-qq-night-mode" target="_blank" rel="noopener">è¶…è¿‡8äº¿äººä½¿ç”¨çš„QQï¼Œæ€»ç»“äº†å¤œé—´æ¨¡å¼è®¾è®¡çš„é€šç”¨æ–¹æ³•</a></p><p><strong>æ¬¢è¿å¤§å®¶æ¥å³åˆ»æ‰¾æˆ‘ç©</strong></p><p><img src="http://ww1.sinaimg.cn/large/0077b3hzgy1fuxyhhcjfcj309e0goaaw.jpg" alt="jike"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;2018å¹´1æœˆï¼ŒYoutube å¯¹ ios å®¢æˆ·ç«¯ç°åº¦å‘å¸ƒå¤œé—´æ¨¡å¼ï¼›2018 WWDC ä¸Šï¼ŒMac OS æ·»åŠ äº†ç³»ç»Ÿçº§çš„å¤œé—´æ¨¡å¼åŠŸèƒ½ï¼Œå¯¹åº”ç”¨è¿›è¡Œå¤œé—´é€‚é…ï¼›18å¹´7æœˆï¼ŒYoutube å¯¹ Android å®¢æˆ·ç«¯ç°åº¦å‘å¸ƒäº†å¤œé—´æ¨¡å¼â€¦â€¦ è€Œåœ¨å›½å†…ï¼Œæ—©æœ‰ä¸€æ‰¹åº”ç”¨æ·»åŠ äº†å®ƒä»¬çš„å¤œé—´æ¨¡å¼ï¼Œé‚£ä¹ˆä½ çš„åº”ç”¨æ˜¯å¦éœ€è¦å¤œé—´æ¨¡å¼ï¼Œåˆè¯¥å¦‚ä½•é€‚é…å‘¢ï¼Ÿ æœ¬æ–‡å°†ä»åº”ç”¨éœ€æ±‚å’Œ Android å®ç°æ–¹æ¡ˆä¸¤ä¸ªè§’åº¦ç®€è¦è®²è¿°~&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://ww1.sinaimg.cn/large/0077b3hzgy1fuxw63tnxnj33c01pb1kx.jpg&quot; alt=&quot;night_example&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
</feed>
